<pre>
    <span class="green">final class </span><span class="blue">PersonDAO </span><span class="green">extends </span><span class="blue"><a href="http://svn.shadanakar.org/filedetails.php?repname=onPHP&path=%2Ftrunk%2Fmain%2FDAOs%2FMappedStorableDAO.class.php&rev=0&sc=0">MappedStorableDAO</a>
    </span><span class="green">{
        </span><span class="orange">// quite obvious mapping
        </span><span class="green">protected </span><span class="blue">$mapping </span><span class="green">= array(
            </span><span class="red">'id'                  </span><span class="green">=&gt; </span><span class="blue">null</span><span class="green">,
            </span><span class="red">'nickname'            </span><span class="green">=&gt; </span><span class="blue">null</span><span class="green">,
            </span><span class="red">'password'            </span><span class="green">=&gt; </span><span class="blue">null</span><span class="green">,
            </span><span class="red">'mail'                </span><span class="green">=&gt; </span><span class="blue">null</span><span class="green">,
            </span><span class="red">'created'             </span><span class="green">=&gt; </span><span class="blue">null</span><span class="green">,
            </span><span class="red">'modified'            </span><span class="green">=&gt; </span><span class="blue">null</span><span class="green">,
            </span><span class="red">'lastLogin'           </span><span class="green">=&gt; </span><span class="red">'last_login'
        </span><span class="green">);
        
        public function </span><span class="blue">getTable</span><span class="green">()
        {
            return </span><span class="red">'person'</span><span class="green">;
        }
        
        public function </span><span class="blue">getSequence</span><span class="green">()
        {
            return </span><span class="red">'person_id'</span><span class="green">;
        }
        
        public function </span><span class="blue">getObjectName</span><span class="green">()
        {
            return </span><span class="red">'Person'</span><span class="green">;
        }

        public function </span><span class="blue">logIn</span><span class="green">(</span><span class="blue">$userName</span><span class="green">, </span><span class="blue">$passWord</span><span class="green">)
        {
            </span><span class="blue">$person </span><span class="green">=
                </span><span class="blue">$this</span><span class="green">-&gt;</span><span class="blue">getByLogic</span><span class="green">(
                    </span><span class="blue"><a href="http://svn.shadanakar.org/filedetails.php?repname=onPHP&path=%2Ftrunk%2Fcore%2FLogic%2FExpression.class.php&rev=0&sc=0">Expression</a></span><span class="green">::</span><span class="blue">expAnd</span><span class="green">(
                        </span><span class="blue"><a href="http://svn.shadanakar.org/filedetails.php?repname=onPHP&path=%2Ftrunk%2Fcore%2FLogic%2FExpression.class.php&rev=0&sc=0">Expression</a></span><span class="green">::</span><span class="blue">eq</span><span class="green">(</span><span class="red">'nickname'</span><span class="green">, </span><span class="blue">$userName</span><span class="green">),
                        </span><span class="blue"><a href="http://svn.shadanakar.org/filedetails.php?repname=onPHP&path=%2Ftrunk%2Fcore%2FLogic%2FExpression.class.php&rev=0&sc=0">Expression</a></span><span class="green">::</span><span class="blue">eq</span><span class="green">(</span><span class="red">'password'</span><span class="green">, </span><span class="blue">$passWord</span><span class="green">)
                    )
                );
                
            return
                </span><span class="orange">// sync last login time
                </span><span class="blue">$this</span><span class="green">-&gt;</span><span class="blue">save</span><span class="green">(
                    </span><span class="blue">$person</span><span class="green">-&gt;</span><span class="blue">setLastLogin</span><span class="green">(
                        new </span><span class="blue"><a href="http://svn.shadanakar.org/filedetails.php?repname=onPHP&path=%2Ftrunk%2Fcore%2FBase%2FTimestamp.class.php&rev=0&sc=0">Timestamp</a></span><span class="green">(</span><span class="blue">time</span><span class="green">())
                    )
                );
        }

        public function </span><span class="blue">makeObject</span><span class="green">(&amp;</span><span class="blue">$array</span><span class="green">, </span><span class="blue">$prefix </span><span class="green">= </span><span class="blue">null</span><span class="green">)
        {
            </span><span class="green">return</span>
                <span class="blue">Person</span><span class="green">::</span><span class="blue">create</span><span class="green">()-&gt;
                </span><span class="blue">setId</span><span class="green">(</span><span class="blue">$array</span><span class="green">[</span><span class="blue">$prefix</span><span class="green">.</span><span class="red">'id'</span><span class="green">])-&gt;
                </span><span class="blue">setNickname</span><span class="green">(</span><span class="blue">$array</span><span class="green">[</span><span class="blue">$prefix</span><span class="green">.</span><span class="red">'nickname'</span><span class="green">])-&gt;
                </span><span class="blue">setPassword</span><span class="green">(</span><span class="blue">$array</span><span class="green">[</span><span class="blue">$prefix</span><span class="green">.</span><span class="red">'password'</span><span class="green">])-&gt;
                </span><span class="blue">setMail</span><span class="green">(</span><span class="blue">$array</span><span class="green">[</span><span class="blue">$prefix</span><span class="green">.</span><span class="red">'mail'</span><span class="green">])-&gt;
                </span><span class="blue">setCreated</span><span class="green">(new </span><span class="blue"><a href="http://svn.shadanakar.org/filedetails.php?repname=onPHP&path=%2Ftrunk%2Fcore%2FBase%2FTimestamp.class.php&rev=0&sc=0">Timestamp</a></span><span class="green">(</span><span class="blue">$array</span><span class="green">[</span><span class="blue">$prefix</span><span class="green">.</span><span class="red">'created'</span><span class="green">]))-&gt;
                </span><span class="blue">setModified</span><span class="green">(new </span><span class="blue"><a href="http://svn.shadanakar.org/filedetails.php?repname=onPHP&path=%2Ftrunk%2Fcore%2FBase%2FTimestamp.class.php&rev=0&sc=0">Timestamp</a></span><span class="green">(</span><span class="blue">$array</span><span class="green">[</span><span class="blue">$prefix</span><span class="green">.</span><span class="red">'modified'</span><span class="green">]))-&gt;
                </span><span class="blue">setLastLogin</span><span class="green">(new </span><span class="blue"><a href="http://svn.shadanakar.org/filedetails.php?repname=onPHP&path=%2Ftrunk%2Fcore%2FBase%2FTimestamp.class.php&rev=0&sc=0">Timestamp</a></span><span class="green">(</span><span class="blue">$array</span><span class="green">[</span><span class="blue">$prefix</span><span class="green">.</span><span class="red">'last_login'</span><span class="green">]));
        }
        
        public function </span><span class="blue">setQueryFields</span><span class="green">(
            </span><span class="blue"><a href="http://svn.shadanakar.org/filedetails.php?repname=onPHP&path=%2Ftrunk%2Fcore%2FOSQL%2FInsertOrUpdateQuery.class.php&rev=0&sc=0">InsertOrUpdateQuery</a> $query</span><span class="green">, </span><span class="blue">Person $person
        </span><span class="green">)
        {
            </span><span class="blue">$now </span><span class="green">= new </span><span class="blue"><a href="http://svn.shadanakar.org/filedetails.php?repname=onPHP&path=%2Ftrunk%2Fcore%2FBase%2FTimestamp.class.php&rev=0&sc=0">Timestamp</a></span><span class="green">(</span><span class="blue">time</span><span class="green">());

            </span><span class="orange">// don't forget about time upon creation
            </span><span class="green">if (</span><span class="blue">$query </span><span class="green">instanceof </span><span class="blue"><a href="http://svn.shadanakar.org/filedetails.php?repname=onPHP&path=%2Ftrunk%2Fcore%2FOSQL%2FInsertQuery.class.php&rev=0&sc=0">InsertQuery</a></span><span class="green">)
                </span><span class="blue">$query</span><span class="green">-&gt;</span><span class="blue">set</span><span class="green">(
                    </span><span class="red">'created'</span><span class="green">,
                    </span><span class="blue">$person</span><span class="green">-&gt;</span><span class="blue">setCreated</span><span class="green">(
                        </span><span class="blue">$now
                    </span><span class="green">)-&gt;
                    </span><span class="blue">getCreated</span><span class="green">()-&gt;</span><span class="blue">toString</span><span class="green">()
                );
            
            return
                </span><span class="blue">$query</span><span class="green">-&gt;
                    </span><span class="orange">// don't forget about time upon any modification too
                    </span><span class="blue">set</span><span class="green">(
                        </span><span class="red">'modified'</span><span class="green">,
                        </span><span class="blue">$person</span><span class="green">-&gt;</span><span class="blue">setModified</span><span class="green">(</span><span class="blue">$now</span><span class="green">)-&gt;
                            </span><span class="blue">getModified</span><span class="green">()-&gt;</span><span class="blue">toString</span><span class="green">()
                    )-&gt;
                    </span><span class="blue">set</span><span class="green">(</span><span class="red">'id'</span><span class="green">, </span><span class="blue">$person</span><span class="green">-&gt;</span><span class="blue">getId</span><span class="green">())-&gt;
                    </span><span class="blue">set</span><span class="green">(</span><span class="red">'nickname'</span><span class="green">, </span><span class="blue">$person</span><span class="green">-&gt;</span><span class="blue">getNickname</span><span class="green">())-&gt;
                    </span><span class="blue">set</span><span class="green">(</span><span class="red">'password'</span><span class="green">, </span><span class="blue">$person</span><span class="green">-&gt;</span><span class="blue">getPassword</span><span class="green">())-&gt;
                    </span><span class="blue">set</span><span class="green">(</span><span class="red">'mail'</span><span class="green">, </span><span class="blue">$person</span><span class="green">-&gt;</span><span class="blue">getMail</span><span class="green">());
        }
    }</span>
</pre>